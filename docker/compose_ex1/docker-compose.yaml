# services:
#   nifi:
#     image: apache/nifi:latest
#     container_name: apache-nifi
#     ports:
#       - "8080:8080"
#       - "8443:8443"
#     environment:
#       - NIFI_WEB_HTTPS_PORT=8443
#       - NIFI_CLUSTER_IS_NODE=false
#       - NIFI_ELECTION_ALWAYS_ELECT_SELF=true
#     volumes:
#       - ./nifi-data/conf:/opt/nifi/nifi-current/conf
#       - ./nifi-data/content:/opt/nifi/nifi-current/content_repository
#       - ./nifi-data/flowfile:/opt/nifi/nifi-current/flowfile_repository
#       - ./nifi-data/provenance:/opt/nifi/nifi-current/provenance_repository
#       - ./nifi-data/database:/opt/nifi/nifi-current/database_repository
#     healthcheck:
#       test:
#         [
#           "CMD",
#           "curl",
#           "-f",
#           "<http://localhost:8080/nifi-api/system-diagnostics>",
#         ]
#       interval: 10s
#       retries: 15

x-ports: &nifi-ports
  NIFI_HTTPS_PORT: 8443 # ‚Üê Change this once (host & container port)

services:
  nifi:
    image: apache/nifi:latest # or apache/nifi:2.0.0 if you want exact version
    container_name: nifi
    restart: unless-stopped
    ports:
      - "8443:8443" # HTTPS UI (default in recent images)
      #- "8080:8080" # if you prefer HTTP (set NIFI_WEB_HTTP_PORT below)
    environment:
      - NIFI_WEB_HTTPS_PORT=8443
      #- NIFI_WEB_HTTP_PORT=8080 # uncomment if you want plain HTTP instead
      - SINGLE_USER_CREDENTIALS_USERNAME=admin
      - SINGLE_USER_CREDENTIALS_PASSWORD=your-strong-password-here # change this!
      - NIFI_PYTHON_COMMAND=python3 # this enables Python support (uncomments/sets internally)
      # Optional: more Python tuning
      - NIFI_PYTHON_MAX_PROCESSES=50
    volumes: # persist state if desired
      - nifi-data:/opt/nifi/nifi-current/state
      - nifi-conf:/opt/nifi/conf # careful: only if you really need to override props
      - nifi-logs:/opt/nifi/logs
    healthcheck:
      test:
        [
          "CMD",
          "curl",
          "-f",
          "<http://localhost:8443/nifi-api/system-diagnostics>",
        ]
      interval: 10s
      retries: 15
volumes:
  nifi-data:
  nifi-conf:
  nifi-logs:
